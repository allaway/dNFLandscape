plot(y = mastsig.df2$CMA1, x= mastsig.df2$sizes)
setwd("~/Documents/dNFLandscape/analysis/2016-12-01")
mast.up <- read.table(Ito_2012_MAST_DOWN.txt)
mast.up <- read.table("Ito_2012_MAST_DOWN.txt")
mast.down <- read.table("Ito_2012_MAST_UP.txt")
mast.up <- read.table("Ito_2012_MAST_DOWN.txt")
mast.down <- read.table("Ito_2012_MAST_UP.txt")
install.packages("datapasta")
browseVignettes()
browseVignettes(datapasta)
browseVignettes("datapasta")
library(datapasta)
mast.up <- read.table("Ito_2012_MAST_DOWN.txt")
mast.down <- read.table("Ito_2012_MAST_UP.txt")
View(mast.up)
mast.up <- read.table("Ito_2012_MAST_DOWN.txt", header = TRUE)
mast.down <- read.table("Ito_2012_MAST_UP.txt", header = TRUE)
View(mastsig.col)
View(mast.up)
mast.up <- read.table("Ito_2012_MAST_DOWN.txt", header = TRUE)
mast.down <- read.table("Ito_2012_MAST_UP.txt", header = TRUE)
source("../../bin/encodeSkinRNASeq.R")
##now get dermal NF data and cluster alongisde
source("../../dermalNF/bin/dermalNFData.R")
dermals=rna_fpkm_matrix(byIsoform=FALSE)
#count_matrix(stored=TRUE,doNorm=FALSE,minCount=2,doLogNorm=FALSE,doVoomNorm=TRUE)
skin=getGeneNamesForMatrix(getEncodeSkinMatrix(metric='FPKM',alignment='hg19',doVoomNorm = FALSE))
over=intersect(rownames(dermals),rownames(skin))
##which annotation should we do? Are they really just duplicates of one another?
##step 1 - just combine all
comb=cbind(dermals[over,],skin[over,])
##step 2, remove values below a particular FPKM, let's say 0.1 - for ALL genes
expr<-1:nrow(comb) #which(apply(comb,1,function(x) all(x>0.2)))
expr<-setdiff(expr,expr[union(grep('MIR',rownames(comb)[expr]),grep("SNO",rownames(comb)[expr]))])
##step 3, normalize
require(limma)
comb.norm=data.frame(voomWithQualityWeights(comb[expr,])$E)
comb.norm$Gene=rownames(comb.norm)
setwd("~/Documents/dNFLandscape/analysis/2016-12-01")
mast.up <- read.table("Ito_2012_MAST_DOWN.txt", header = TRUE)
mast.down <- read.table("Ito_2012_MAST_UP.txt", header = TRUE)
source("../../bin/encodeSkinRNASeq.R")
##now get dermal NF data and cluster alongisde
source("../../dermalNF/bin/dermalNFData.R")
dermals=rna_fpkm_matrix(byIsoform=FALSE)
#count_matrix(stored=TRUE,doNorm=FALSE,minCount=2,doLogNorm=FALSE,doVoomNorm=TRUE)
skin=getGeneNamesForMatrix(getEncodeSkinMatrix(metric='FPKM',alignment='hg19',doVoomNorm = FALSE))
over=intersect(rownames(dermals),rownames(skin))
##which annotation should we do? Are they really just duplicates of one another?
##step 1 - just combine all
comb=cbind(dermals[over,],skin[over,])
##step 2, remove values below a particular FPKM, let's say 0.1 - for ALL genes
expr<-1:nrow(comb) #which(apply(comb,1,function(x) all(x>0.2)))
expr<-setdiff(expr,expr[union(grep('MIR',rownames(comb)[expr]),grep("SNO",rownames(comb)[expr]))])
##step 3, normalize
require(limma)
comb.norm=data.frame(voomWithQualityWeights(comb[expr,])$E)
comb.norm$Gene=rownames(comb.norm)
View(mast.down)
mast.up <- as.data.frame(cbind(mast.up, c(rep.int("DOWN", 190))))
mast.up <- read.table("Ito_2012_MAST_UP.txt", header = TRUE)
mast.up <- as.data.frame(cbind(mast.up, c(rep.int("DOWN", 190))))
mast.up <- as.data.frame(cbind(mast.up, c(rep.int("UP", 190))))
View(mast.up)
mast.up <- read.table("Ito_2012_MAST_UP.txt", header = TRUE)
UP <- c(rep.int("UP", 190)
mast.up <- as.data.frame(cbind(mast.up, UP)))
UP <- c(rep.int("UP", 190))
mast.up <- as.data.frame(cbind(mast.up, UP)))
mast.up <- as.data.frame(cbind(mast.up, UP))
View(mast.up)
mast.down <- read.table("Ito_2012_MAST_DOWN.txt", header = TRUE)
DOWN <- c(rep.int("DOWN", 493))
mast.down <- as.data.frame(cbind(mast.down, DOWN))
mast.activation <- rbind(mast.up, mast.down)
mast.activation <- dplyr::bind_rows(mast.up, mast.down)
View(mast.activation)
mast.up <- read.table("Ito_2012_MAST_UP.txt", header = TRUE)
mast.down <- read.table("Ito_2012_MAST_DOWN.txt", header = TRUE)
direction <- c(rep.int("UP", 190), rep.int("DOWN", 493))
mast.activation <- dplyr::bind_rows(mast.up, mast.down)
mast.activation <- dplyr::bind_cols(mast.activation, direction)
View(mast.activation)
mast.up <- read.table("Ito_2012_MAST_UP.txt", header = TRUE)
mast.down <- read.table("Ito_2012_MAST_DOWN.txt", header = TRUE)
direction <- c(rep.int("UP", 190), rep.int("DOWN", 493))
mast.activation <- dplyr::bind_rows(mast.up, mast.down)
mast.up <- read.table("Ito_2012_MAST_UP.txt", header = TRUE)
mast.down <- read.table("Ito_2012_MAST_DOWN.txt", header = TRUE)
direction <- c(rep.int("UP", 190), rep.int("DOWN", 451))
mast.activation <- dplyr::bind_rows(mast.up, mast.down)
View(mast.up)
View(mast.activation)
mast.activation <- dplyr::bind_cols(mast.activation, direction)
mast.up <- as.data.frame(read.table("Ito_2012_MAST_UP.txt", header = TRUE))
mast.down <- as.data.frame(read.table("Ito_2012_MAST_DOWN.txt", header = TRUE))
direction <- c(rep.int("UP", 190), rep.int("DOWN", 451))
mast.activation <- dplyr::bind_rows(mast.up, mast.down)
direction <- as.data.frame(c(rep.int("UP", 190), rep.int("DOWN", 451)))
mast.activation <- dplyr::bind_rows(mast.up, mast.down)
mast.activation <- dplyr::bind_cols(mast.activation, direction)
View(mast.activation)
direction <- as.data.frame(c(rep.int("UP", 190), rep.int("DOWN", 451)))
mast.activation <- dplyr::bind_rows(mast.up, mast.down)
mast.activation <- dplyr::bind_cols(mast.activation, direction)
mast.up <- unique(as.data.frame(read.table("Ito_2012_MAST_UP.txt", header = TRUE)))
mast.down <- unique(as.data.frame(read.table("Ito_2012_MAST_DOWN.txt", header = TRUE)))
direction <- as.data.frame(c(rep.int("UP", 151), rep.int("DOWN", 346)))
mast.activation <- dplyr::bind_rows(mast.up, mast.down)
mast.activation <- dplyr::bind_cols(mast.activation, direction)
View(mast.activation)
View(comb.norm)
View(comb)
View(comb.norm)
mast.up <- unique(as.data.frame(read.table("Ito_2012_MAST_UP.txt", header = TRUE)))
mast.down <- unique(as.data.frame(read.table("Ito_2012_MAST_DOWN.txt", header = TRUE)))
direction <- as.data.frame(c(rep.int("UP", 151), rep.int("DOWN", 346)))
mast.activation <- dplyr::bind_rows(mast.up, mast.down)
mast.activation <- dplyr::bind_cols(mast.activation, direction)
direction <- as.data.frame(direction <- c(rep.int("UP", 151), rep.int("DOWN", 346)))
mast.activation <- dplyr::bind_rows(mast.up, mast.down)
mast.activation <- dplyr::bind_cols(mast.activation, direction)
mast.up <- unique(as.data.frame(read.table("Ito_2012_MAST_UP.txt", header = TRUE)))
mast.down <- unique(as.data.frame(read.table("Ito_2012_MAST_DOWN.txt", header = TRUE)))
direction <- as.data.frame(direction <- c(rep.int("UP", 151), rep.int("DOWN", 346)))
mast.activation <- dplyr::bind_rows(mast.up, mast.down)
mast.activation <- dplyr::bind_cols(mast.activation, direction)
View(mast.activation)
mast.up <- unique(as.data.frame(read.table("Ito_2012_MAST_UP.txt", header = TRUE)))
mast.down <- unique(as.data.frame(read.table("Ito_2012_MAST_DOWN.txt", header = TRUE)))
direction <- c(rep.int("UP", 151), rep.int("DOWN", 346)
direction <- as.data.frame(direction)
mast.up <- unique(as.data.frame(read.table("Ito_2012_MAST_UP.txt", header = TRUE)))
mast.down <- unique(as.data.frame(read.table("Ito_2012_MAST_DOWN.txt", header = TRUE)))
direction <- c(rep.int("UP", 151), rep.int("DOWN", 346))
direction <- as.data.frame(direction)
mast.activation <- dplyr::bind_rows(mast.up, mast.down)
View(mast.activation)
mast.activation <- dplyr::bind_cols(mast.activation, direction)
View(mast.activation)
dplyr::semi_join(comb.norm, mast.activation, by = "Gene")
mast.activation.labeled <- dplyr::semi_join(comb.norm, mast.activation, by = "Gene")
View(mast.activation.labeled)
mast.up <- toupper(unique(as.data.frame(read.table("Ito_2012_MAST_UP.txt", header = TRUE))))
mast.down <- toupper(unique(as.data.frame(read.table("Ito_2012_MAST_DOWN.txt", header = TRUE))))
mast.down <- unique(as.data.frame(toupper(read.table("Ito_2012_MAST_DOWN.txt", header = TRUE))))
mast.down <- unique(as.data.frame(toupper(read.table("Ito_2012_MAST_DOWN.txt", header = TRUE))))
mast.up <- unique(as.data.frame(toupper(read.table("Ito_2012_MAST_UP.txt", header = TRUE))))
mast.down <- unique(as.data.frame(toupper(read.table("Ito_2012_MAST_DOWN.txt", header = TRUE))))
View(mast.down)
mast.down <- unique(as.data.frame(read.table("Ito_2012_MAST_DOWN.txt", header = TRUE)))
mast.up <- unique(as.data.frame(read.table("Ito_2012_MAST_UP.txt", header = TRUE)))
mast.down <- unique(as.data.frame(read.table("Ito_2012_MAST_DOWN.txt", header = TRUE)))
View(mast.down)
mast.up <- toupper(mast.up, [,1])
mast.up <- toupper(mast.up [,1])
mast.up <- unique(read.table("Ito_2012_MAST_UP.txt", header = TRUE))
mast.up <- toupper(mast.up[,1])
mast.down <- unique(read.table("Ito_2012_MAST_DOWN.txt", header = TRUE))
mast.down <- toupper(mast.down[,1])
direction <- c(rep.int("UP", 151), rep.int("DOWN", 346))
direction <- as.data.frame(direction)
mast.activation <- dplyr::bind_rows(mast.up, mast.down)
mast.up <- as.data.frame(toupper(mast.up[,1]))
mast.up <- unique(read.table("Ito_2012_MAST_UP.txt", header = TRUE))
mast.up <- as.data.frame(toupper(mast.up[,1]))
View(mast.up)
mast.up <- unique(read.table("Ito_2012_MAST_UP.txt", header = TRUE))
mast.up <- toupper(mast.up[,1])
mast.up <- as.data.frame(mast.up)
mast.down <- unique(read.table("Ito_2012_MAST_DOWN.txt", header = TRUE))
mast.down <- toupper(mast.down[,1])
mast.down <- as.data.frame(mast.down)
direction <- c(rep.int("UP", 151), rep.int("DOWN", 346))
direction <- as.data.frame(direction)
mast.activation <- dplyr::bind_rows(mast.up, mast.down)
mast.activation <- dplyr::bind_cols(mast.activation, direction)
View(mast.activation)
rownames(mast.up) <- c("Gene")
rownames("Gene") <- mast.up
?rownames
colnames(mast.up) <- c("Gene")
View(mast.up)
rownames(mast.up) <- c("Gene")
colnames(mast.down) <- c("Gene")
mast.up <- unique(read.table("Ito_2012_MAST_UP.txt", header = TRUE))
mast.up <- toupper(mast.up[,1])
mast.up <- as.data.frame(mast.up)
colnames(mast.up) <- c("Gene")
mast.down <- unique(read.table("Ito_2012_MAST_DOWN.txt", header = TRUE))
mast.down <- toupper(mast.down[,1])
mast.down <- as.data.frame(mast.down)
colnames(mast.down) <- c("Gene")
direction <- c(rep.int("UP", 151), rep.int("DOWN", 346))
direction <- as.data.frame(direction)
mast.activation <- dplyr::bind_rows(mast.up, mast.down)
mast.activation <- dplyr::bind_cols(mast.activation, direction)
View(mast.activation)
mast.activation.labeled <- dplyr::semi_join(comb.norm, mast.activation, by = "Gene")
View(mast.activation.labeled)
View(mast.activation)
mast.activation.labeled <- dplyr::semi_join (mast.activation, mast.activation.labeled, by = "Gene")
View(mast.activation.labeled)
View(mast.activation.labeled)
mast.activation.labeled <- dplyr::semi_join(comb.norm, mast.activation, by = "Gene")
mast.activation.labeled <- dplyr::semi_join (mast.activation.labeled, mast.activation, by = "Gene")
View(mast.activation.labeled)
mast.activation.labeled <- dplyr::semi_join(comb.norm, mast.activation, by = "Gene")
mast.activation.status <- dplyr::semi_join (mast.activation, mast.activation.labeled, by = "Gene")
View(mast.activation.status)
mast.activation.labeled <- dplyr::full_join(mast.activation.labeled, mast.activation.status, by = "Gene")
View(mast.activation.labeled)
View(mast.activation.labeled)
mast.activation.labeled <- dplyr::semi_join(comb.norm, mast.activation, by = "Gene")
mast.activation.Itosig <- dplyr::semi_join(comb.norm, mast.activation, by = "Gene")
mast.activation.Itosig <- dplyr::semi_join(comb.norm, mast.activation, by = "Gene")
mast.activation.labels <- dplyr::semi_join (mast.activation, mast.activation.Itosig, by = "Gene")
is.data.frame(mast.activation.Itosig)
pheatmap(mast.activation.Itosig, cellwidth = 5, cellheight = 5, fontsize = 5, treeheight_col= 40, treeheight_row = 40, border_color = "grey", annotation_row = mast.activation.labels)
pheatmap(mast.activation.Itosig, cellwidth = 5, cellheight = 5, fontsize = 5, treeheight_col= 40, treeheight_row = 40, border_color = "grey")
pheatmap::pheatmap(mast.activation.Itosig, cellwidth = 5, cellheight = 5, fontsize = 5, treeheight_col= 40, treeheight_row = 40, border_color = "grey")
rownames(mast.activation.Itosig) <- mast.activation.Itosig$Gene
mast.activation.Itosig <- mast.activation.Itosi[,1:66]
mast.activation.Itosig <- mast.activation.Itosig[,1:66]
pheatmap::pheatmap(mast.activation.Itosig, cellwidth = 5, cellheight = 5, fontsize = 5, treeheight_col= 40, treeheight_row = 40, border_color = "grey", annotation_row = mast.activation.labels)
View(mast.activation.Itosig)
mast.activation.Itosig <- dplyr::semi_join(comb.norm, mast.activation, by = "Gene")
mast.activation.labels <- dplyr::semi_join (mast.activation, mast.activation.Itosig, by = "Gene")
rownames(mast.activation.labels) <- mast.activation.labels$Gene
mast.activation.labels <- mast.activation.labels[,1]
rownames(mast.activation.Itosig) <- mast.activation.Itosig$Gene
mast.activation.Itosig <- mast.activation.Itosig[,1:66]
pheatmap::pheatmap(mast.activation.Itosig, cellwidth = 5, cellheight = 5, fontsize = 5, treeheight_col= 40, treeheight_row = 40, border_color = "grey", annotation_row = mast.activation.labels)
pheatmap::pheatmap(mast.activation.Itosig, cellwidth = 5, cellheight = 5, fontsize = 5, treeheight_col= 40, treeheight_row = 40, border_color = "grey"
pheatmap::pheatmap(mast.activation.Itosig, cellwidth = 5, cellheight = 5, fontsize = 5, treeheight_col= 40, treeheight_row = 40, border_color = "grey")
pheatmap::pheatmap(mast.activation.Itosig, cellwidth = 5, cellheight = 5, fontsize = 5, treeheight_col= 40, treeheight_row = 40, border_color = "grey")
pheatmap::pheatmap(mast.activation.Itosig, cellwidth = 5, cellheight = 2, fontsize = 5, treeheight_col= 40, treeheight_row = 40, border_color = "grey")
pheatmap::pheatmap(mast.activation.Itosig, cellwidth = 5, cellheight = 1, fontsize = 1, treeheight_col= 40, treeheight_row = 40, border_color = "grey")
pheatmap::pheatmap(mast.activation.Itosig, cluster_cols = FALSE, cellwidth = 5, cellheight = 1, fontsize = 1, treeheight_col= 40, treeheight_row = 40, border_color = "grey")
pheatmap::pheatmap(mast.activation.Itosig, cluster_rows = FALSE, cellwidth = 5, cellheight = 1, fontsize = 1, treeheight_col= 40, treeheight_row = 40, border_color = "grey")
pheatmap::pheatmap(mast.activation.Itosig, cluster_rows = FALSE, cellwidth = 5, cellheight = 1, fontsize = 1, treeheight_col= 40, treeheight_row = 40, border_color = "grey", annotation_row = mast.activation.labels)
library(car)
install.packages(car)
install.packages("car")
mast.activation.labels <- car::recode(mast.activation.labels, "UP" = 1, "DOWN" = 0)
mast.activation.labels <- car::recode(mast.activation.labels, "UP" = 1; "DOWN" = 0)
mast.activation.labels <- car::recode(mast.activation.labels, '"UP" = 1; "DOWN" = 0')
mast.activation.labels[mast.activation.labels=="UP"] <- 1
rownames(mast.activation.labels) <- mast.activation.labels$Gene
mast.activation.labels <- mast.activation.labels[,1]
mast.activation.Itosig <- dplyr::semi_join(comb.norm, mast.activation, by = "Gene")
mast.activation.labels <- dplyr::semi_join (mast.activation, mast.activation.Itosig, by = "Gene")
rownames(mast.activation.labels) <- mast.activation.labels$Gene
mast.activation.labels <- mast.activation.labels[,1]
mast.activation.labels[mast.activation.labels=="UP"] <- 1
mast.up <- unique(read.table("Ito_2012_MAST_UP.txt", header = TRUE))
mast.up <- toupper(mast.up[,1])
mast.up <- as.data.frame(mast.up)
colnames(mast.up) <- c("Gene")
mast.down <- unique(read.table("Ito_2012_MAST_DOWN.txt", header = TRUE))
mast.down <- toupper(mast.down[,1])
mast.down <- as.data.frame(mast.down)
colnames(mast.down) <- c("Gene")
direction <- c(rep.int("UP", 151), rep.int("DOWN", 346))
direction <- as.data.frame(direction)
mast.activation <- dplyr::bind_rows(mast.up, mast.down)
mast.activation <- dplyr::bind_cols(mast.activation, direction)
mast.activation.Itosig <- dplyr::semi_join(comb.norm, mast.activation, by = "Gene")
mast.activation.labels <- dplyr::semi_join (mast.activation, mast.activation.Itosig, by = "Gene")
rownames(mast.activation.labels) <- mast.activation.labels$Gene
mast.activation.labels <- mast.activation.labels[,1]
rownames(mast.activation.Itosig) <- mast.activation.Itosig$Gene
mast.activation.Itosig <- mast.activation.Itosig[,1:66]
mast.activation.labels <- dplyr::semi_join (mast.activation, mast.activation.Itosig, by = "Gene")
mast.activation.Itosig <- dplyr::semi_join(comb.norm, mast.activation, by = "Gene")
mast.activation.labels <- dplyr::semi_join (mast.activation, mast.activation.Itosig, by = "Gene")
rownames(mast.activation.labels) <- mast.activation.labels$Gene
mast.activation.labels <- mast.activation.labels[,1]
mast.activation.labels <- dplyr::semi_join (mast.activation, mast.activation.Itosig, by = "Gene")
View(mast.activation.labels)
mast.activation.labels[mast.activation.labels=="UP"] <- 1
rownames(mast.activation.labels) <- mast.activation.labels$Gene
mast.activation.labels[mast.activation.labels=="UP"] <- 1
View(mast.activation.labels)
mast.activation.Itosig <- dplyr::semi_join(comb.norm, mast.activation, by = "Gene")
mast.activation.labels <- dplyr::semi_join (mast.activation, mast.activation.Itosig, by = "Gene")
rownames(mast.activation.labels) <- mast.activation.labels$Gene
mast.activation.labels[mast.activation.labels=="UP"] <- 1
pheatmap::pheatmap(mast.activation.Itosig, cluster_rows = FALSE, cluster_cols = FALSE, cellwidth = 5, cellheight = 1, fontsize = 1,
treeheight_col= 40, treeheight_row = 40, border_color = "grey", annotation_row = mast.activation.labels)
mast.activation.Itosig <- dplyr::semi_join(comb.norm, mast.activation, by = "Gene")
mast.activation.labels <- dplyr::semi_join (mast.activation, mast.activation.Itosig, by = "Gene")
rownames(mast.activation.labels) <- mast.activation.labels$Gene
mast.activation.labels <- mast.activation.labels[,1]
rownames(mast.activation.Itosig) <- mast.activation.Itosig$Gene
mast.activation.Itosig <- mast.activation.Itosig[,1:66]
pheatmap::pheatmap(mast.activation.Itosig, cluster_rows = FALSE, cluster_cols = FALSE, cellwidth = 5, cellheight = 1, fontsize = 1,
treeheight_col= 40, treeheight_row = 40, border_color = "grey", annotation_row = mast.activation.labels)
pheatmap::pheatmap(mast.activation.Itosig, cluster_rows = FALSE, cluster_cols = FALSE, cellwidth = 5, cellheight = 1, fontsize = 1,
treeheight_col= 40, treeheight_row = 40, border_color = "grey") ##annotation_row = mast.activation.labels
pheatmap::pheatmap(mast.activation.Itosig, cluster_rows = FALSE, cellwidth = 5, cellheight = 1, fontsize = 1,
treeheight_col= 40, treeheight_row = 40, border_color = "grey") ##annotation_row = mast.activation.labels
View(mast.activation.status)
rownames(mast.activation.labels) <- mast.activation.labels$Gene
mast.activation.Itosig <- dplyr::semi_join(comb.norm, mast.activation, by = "Gene")
mast.activation.labels <- dplyr::semi_join (mast.activation, mast.activation.Itosig, by = "Gene")
rownames(mast.activation.labels) <- mast.activation.labels$Gene
mast.activation.labels <- mast.activation.labels[,1]
mast.activation.Itosig <- dplyr::semi_join(comb.norm, mast.activation, by = "Gene")
mast.activation.labels <- dplyr::semi_join (mast.activation, mast.activation.Itosig, by = "Gene")
rownames(mast.activation.labels) <- mast.activation.labels$Gene
View(mast.activation.labels)
mast.activation.labels <- mast.activation.labels$direction
mast.activation.labels <- dplyr::semi_join (mast.activation, mast.activation.Itosig, by = "Gene")
rownames(mast.activation.labels) <- mast.activation.labels$Gene
mast.activation.labels <- mast.activation.labels[1:372, 2]
mast.activation.labels <- dplyr::semi_join (mast.activation, mast.activation.Itosig, by = "Gene")
rownames(mast.activation.labels) <- mast.activation.labels$Gene
mast.activation.labels <- mast.activation.labels[2, ]
View(mast.activation.labels)
mast.activation.labels <- mast.activation.labels[1:372, -1]
mast.activation.Itosig <- dplyr::semi_join(comb.norm, mast.activation, by = "Gene")
mast.activation.labels <- dplyr::semi_join (mast.activation, mast.activation.Itosig, by = "Gene")
rownames(mast.activation.labels) <- mast.activation.labels$Gene
mast.activation.labels <- mast.activation.labels[1:372, -1]
mast.activation.Itosig <- dplyr::semi_join(comb.norm, mast.activation, by = "Gene")
mast.activation.labels <- dplyr::semi_join (mast.activation, mast.activation.Itosig, by = "Gene")
rownames(mast.activation.labels) <- mast.activation.labels$Gene
mast.activation.labels <- mast.activation.labels[1:372, -2]
372-116
rownames(mast.activation.labels) <- mast.activation.labels$Gene
dirnum <- c(rep.int(1, 116), rep.int(0, 256))
mast.activation.Itosig <- dplyr::semi_join(comb.norm, mast.activation, by = "Gene")
mast.activation.labels <- dplyr::semi_join (mast.activation, mast.activation.Itosig, by = "Gene")
rownames(mast.activation.labels) <- mast.activation.labels$Gene
dirnum <- c(rep.int(1, 116), rep.int(0, 256))
mast.activation.labels <- cbind(mast.activation.labels, dirnum)
View(mast.activation.labels)
mast.activation.Itosig <- dplyr::semi_join(comb.norm, mast.activation, by = "Gene")
mast.activation.labels <- dplyr::semi_join (mast.activation, mast.activation.Itosig, by = "Gene")
rownames(mast.activation.labels) <- mast.activation.labels$Gene
dirnum <- c(rep.int(1, 116), rep.int(0, 256))
mast.activation.labels <- cbind(mast.activation.labels, dirnum)
rownames(mast.activation.Itosig) <- mast.activation.Itosig$Gene
mast.activation.Itosig <- mast.activation.Itosig[,1:66]
pheatmap::pheatmap(mast.activation.Itosig, cluster_rows = FALSE, cellwidth = 5, cellheight = 1, fontsize = 1,
treeheight_col= 40, treeheight_row = 40, border_color = "grey" , annotation_row = mast.activation.labels$dirnum)
pheatmap::pheatmap(mast.activation.Itosig, cluster_rows = FALSE, cellwidth = 5, cellheight = 1, fontsize = 1,
treeheight_col= 40, treeheight_row = 40, border_color = "grey" , annotation_row = mast.activation.labels[,3])
mast.activation.labels <- dplyr::slice(cbind(mast.activation.labels, dirnum), 3)
mast.activation.Itosig <- dplyr::semi_join(comb.norm, mast.activation, by = "Gene")
mast.activation.labels <- dplyr::semi_join (mast.activation, mast.activation.Itosig, by = "Gene")
rownames(mast.activation.labels) <- mast.activation.labels$Gene
dirnum <- c(rep.int(1, 116), rep.int(0, 256))
mast.activation.labels <- dplyr::slice(cbind(mast.activation.labels, dirnum), 3)
View(mast.activation.labels)
rownames(mast.activation.labels) <- mast.activation.labels$Gene
dirnum <- c(rep.int(1, 116), rep.int(0, 256))
mast.activation.labels <- dplyr::select(cbind(mast.activation.labels, dirnum), dirnum)
mast.activation.Itosig <- dplyr::semi_join(comb.norm, mast.activation, by = "Gene")
mast.activation.labels <- dplyr::semi_join (mast.activation, mast.activation.Itosig, by = "Gene")
rownames(mast.activation.labels) <- mast.activation.labels$Gene
dirnum <- c(rep.int(1, 116), rep.int(0, 256))
mast.activation.labels <- cbind(mast.activation.labels, dirnum)
mast.activation.labels <- dplyr::select(mast.activation.labels, dirnum)
View(mast.activation.labels)
pheatmap::pheatmap(mast.activation.Itosig, cluster_rows = FALSE, cellwidth = 5, cellheight = 1, fontsize = 1,
treeheight_col= 40, treeheight_row = 40, border_color = "grey" , annotation_row = mast.activation.labels)
mast.activation.Itosig <- dplyr::semi_join(comb.norm, mast.activation, by = "Gene")
mast.activation.labels <- dplyr::semi_join (mast.activation, mast.activation.Itosig, by = "Gene")
rownames(mast.activation.labels) <- mast.activation.labels$Gene
dirnum <- c(rep.int(1, 116), rep.int(0, 256))
mast.activation.labels <- cbind(mast.activation.labels, dirnum)
mast.activation.labels <- dplyr::select(mast.activation.labels, dirnum)
rownames(mast.activation.Itosig) <- mast.activation.Itosig$Gene
mast.activation.Itosig <- mast.activation.Itosig[,1:66]
pheatmap::pheatmap(mast.activation.Itosig, cluster_rows = FALSE, cellwidth = 5, cellheight = 1, fontsize = 1,
treeheight_col= 40, treeheight_row = 40, border_color = "grey" , annotation_row = mast.activation.labels)
"mast.activation.Itosig.pdf" <- pheatmap::pheatmap(mast.activation.Itosig, cluster_rows = FALSE, cellwidth = 5, cellheight = 1, fontsize = 1,
treeheight_col= 40, treeheight_row = 40, border_color = "grey" , annotation_row = mast.activation.labels)
pdf("mast.activation.Itosig.pdf")
pheatmap::pheatmap(mast.activation.Itosig, cluster_rows = FALSE, cellwidth = 5, cellheight = 1, fontsize = 1,
treeheight_col= 40, treeheight_row = 40, border_color = "grey" , annotation_row = mast.activation.labels)
dev.off()
pheatmap::pheatmap(mast.activation.Itosig, cluster_rows = FALSE, cellwidth = 5, cellheight = 4, fontsize = 1,
treeheight_col= 40, treeheight_row = 40, border_color = "grey" , annotation_row = mast.activation.labels)
pdf("mast.activation.Itosig.pdf")
pheatmap::pheatmap(mast.activation.Itosig, cluster_rows = FALSE, cellwidth = 5, cellheight = 4, fontsize = 1,
treeheight_col= 40, treeheight_row = 40, border_color = "grey" , annotation_row = mast.activation.labels)
dev.off()
pdf("mast.activation.Itosig.pdf", height = 10)
pheatmap::pheatmap(mast.activation.Itosig, cluster_rows = FALSE, cellwidth = 5, cellheight = 4, fontsize = 1,
treeheight_col= 40, treeheight_row = 40, border_color = "grey" , annotation_row = mast.activation.labels)
dev.off()
pdf("mast.activation.Itosig.pdf", height = 10)
pheatmap::pheatmap(mast.activation.Itosig, cluster_rows = FALSE, cellwidth = 5, cellheight = 3, fontsize = 1,
treeheight_col= 40, treeheight_row = 40, border_color = "grey" , annotation_row = mast.activation.labels)
dev.off()
pdf("mast.activation.Itosig.pdf", height = 10)
pheatmap::pheatmap(mast.activation.Itosig, cluster_rows = FALSE, cellwidth = 5, cellheight = 2, fontsize = 1,
treeheight_col= 40, treeheight_row = 40, border_color = "grey" , annotation_row = mast.activation.labels)
dev.off()
pdf("mast.activation.Itosig.pdf", height = 15)
pheatmap::pheatmap(mast.activation.Itosig, cluster_rows = FALSE, cellwidth = 5, cellheight = 2, fontsize = 1,
treeheight_col= 40, treeheight_row = 40, border_color = "grey" , annotation_row = mast.activation.labels)
dev.off()
pdf("mast.activation.Itosig.pdf", height = 15)
pheatmap::pheatmap(mast.activation.Itosig, cluster_rows = FALSE, cellwidth = 5, cellheight = 2, fontsize = 2,
treeheight_col= 40, treeheight_row = 40, border_color = "grey" , annotation_row = mast.activation.labels)
dev.off()
pdf("mast.activation.Itosig.pdf", height = 15)
pheatmap::pheatmap(mast.activation.Itosig, cluster_rows = TRUE, cellwidth = 5, cellheight = 2, fontsize = 2,
treeheight_col= 40, treeheight_row = 40, border_color = "grey" , annotation_row = mast.activation.labels)
dev.off()
pdf("mast.activation.Itosig.pdf", height = 15)
pheatmap::pheatmap(mast.activation.Itosig, cluster_rows = FALSE, cellwidth = 5, cellheight = 2, fontsize = 2,
treeheight_col= 40, treeheight_row = 40, border_color = "grey" , annotation_row = mast.activation.labels)
dev.off()
pdf("mast.activation.Itosig.pdf", height = 15)
pheatmap::pheatmap(mast.activation.Itosig, cluster_rows = FALSE, cellwidth = 5, cellheight = 2, fontsize = 2,
treeheight_col= 40, treeheight_row = 40, border_color = "grey" , annotation_row = mast.activation.labels)
pheatmap::pheatmap(mast.activation.Itosig, cellwidth = 5, cellheight = 2, fontsize = 2,
treeheight_col= 40, treeheight_row = 40, border_color = "grey" , annotation_row = mast.activation.labels)
dev.off()
pheatmap::pheatmap(mast.activation.Itosig[1:116])
pheatmap::pheatmap(mast.activation.Itosig[1:116,1:66])
pheatmap::pheatmap(mast.activation.Itosig[1:116,1:66], cellwidth = 5, cellheight = 2, fontsize = 2,
treeheight_col= 40, treeheight_row = 40, border_color = "grey" , annotation_row = mast.activation.labels[1:116, 1])
pheatmap::pheatmap(mast.activation.Itosig[1:116,1:66], cellwidth = 5, cellheight = 2, fontsize = 2,
treeheight_col= 40, treeheight_row = 40, border_color = "grey" , annotation_row = mast.activation.labels[1:116,])
pheatmap::pheatmap(mast.activation.Itosig[1:116,1:66], cellwidth = 5, cellheight = 2, fontsize = 2,
treeheight_col= 40, treeheight_row = 40, border_color = "grey" , annotation_row = dirnum[1:116,])
pdf("mast.activation.Itosig.pdf", height = 15)
pheatmap::pheatmap(mast.activation.Itosig, cluster_rows = FALSE, cellwidth = 5, cellheight = 2, fontsize = 2,
treeheight_col= 40, treeheight_row = 40, border_color = "grey" , annotation_row = mast.activation.labels)
pheatmap::pheatmap(mast.activation.Itosig, cellwidth = 5, cellheight = 2, fontsize = 2,
treeheight_col= 40, treeheight_row = 40, border_color = "grey" , annotation_row = mast.activation.labels)
pheatmap::pheatmap(mast.activation.Itosig[1:116,1:66], cellwidth = 5, cellheight = 2, fontsize = 2,
treeheight_col= 40, treeheight_row = 40, border_color = "grey")
pheatmap::pheatmap(mast.activation.Itosig[117:372,1:66], cellwidth = 5, cellheight = 2, fontsize = 2,
treeheight_col= 40, treeheight_row = 40, border_color = "grey")
dev.off()
View(mast.activation.Itosig)
pheatmap::pheatmap(mast.activation.Itosig[117:372,1:33], cellwidth = 5, cellheight = 2, fontsize = 2,
treeheight_col= 40, treeheight_row = 40, border_color = "grey")
pheatmap::pheatmap(mast.activation.Itosig[,1:33], cellwidth = 5, cellheight = 2, fontsize = 2,
treeheight_col= 40, treeheight_row = 40, border_color = "grey", annotation_row = mast.activation.labels)
pheatmap::pheatmap(mast.activation.Itosig[,1:33], cellwidth = 5, cellheight = 2, fontsize = 2, cluster_rows = FALSE,
treeheight_col= 40, treeheight_row = 40, border_color = "grey", annotation_row = mast.activation.labels)
pdf("mast.activation.Itosig.pdf", height = 15)
pheatmap::pheatmap(mast.activation.Itosig, cluster_rows = FALSE, cellwidth = 5, cellheight = 2, fontsize = 2,
treeheight_col= 40, treeheight_row = 40, border_color = "grey" , annotation_row = mast.activation.labels)
pheatmap::pheatmap(mast.activation.Itosig, cellwidth = 5, cellheight = 2, fontsize = 2,
treeheight_col= 40, treeheight_row = 40, border_color = "grey" , annotation_row = mast.activation.labels)
pheatmap::pheatmap(mast.activation.Itosig[1:116,1:66], cellwidth = 5, cellheight = 2, fontsize = 2,
treeheight_col= 40, treeheight_row = 40, border_color = "grey")
pheatmap::pheatmap(mast.activation.Itosig[117:372,1:66], cellwidth = 5, cellheight = 2, fontsize = 2,
treeheight_col= 40, treeheight_row = 40, border_color = "grey")
pheatmap::pheatmap(mast.activation.Itosig[,1:33], cellwidth = 5, cellheight = 2, fontsize = 2, cluster_rows = FALSE,
treeheight_col= 40, treeheight_row = 40, border_color = "grey", annotation_row = mast.activation.labels)
dev.off()
pheatmap::pheatmap(mast.activation.Itosig[,1:33], cellwidth = 5, cellheight = 2, fontsize = 2, cluster_rows = T,
treeheight_col= 40, treeheight_row = 40, border_color = "grey", annotation_row = mast.activation.labels)
pdf("mast.activation.Itosig.pdf", height = 15)
pheatmap::pheatmap(mast.activation.Itosig, cluster_rows = FALSE, cellwidth = 5, cellheight = 2, fontsize = 2,
treeheight_col= 40, treeheight_row = 40, border_color = "grey" , annotation_row = mast.activation.labels)
pheatmap::pheatmap(mast.activation.Itosig, cellwidth = 5, cellheight = 2, fontsize = 2,
treeheight_col= 40, treeheight_row = 40, border_color = "grey" , annotation_row = mast.activation.labels)
pheatmap::pheatmap(mast.activation.Itosig[1:116,1:66], cellwidth = 5, cellheight = 2, fontsize = 2,
treeheight_col= 40, treeheight_row = 40, border_color = "grey")
pheatmap::pheatmap(mast.activation.Itosig[117:372,1:66], cellwidth = 5, cellheight = 2, fontsize = 2,
treeheight_col= 40, treeheight_row = 40, border_color = "grey")
pheatmap::pheatmap(mast.activation.Itosig[,1:33], cellwidth = 5, cellheight = 2, fontsize = 2, cluster_rows = FALSE,
treeheight_col= 40, treeheight_row = 40, border_color = "grey", annotation_row = mast.activation.labels)
pheatmap::pheatmap(mast.activation.Itosig[,1:33], cellwidth = 5, cellheight = 2, fontsize = 2, cluster_rows = TRUE,
treeheight_col= 40, treeheight_row = 40, border_color = "grey", annotation_row = mast.activation.labels)
dev.off()
require(synapseClient)
synapseLogin()
cs.res<-read.table(synGet('syn5809355')@filePath,sep=',',header=T)
res<-synQuery("select patientID,tissueID,sampleID from entity where parentId=='syn5492805'")
tres<-synTableQuery("SELECT Patient,RnaID,TumorNumber,'RNASeq (Cufflinks)' FROM syn5556216 where RnaID is not NULL")@values
idx<-match(res$entity.id,tres$`RNASeq (Cufflinks)`)
dres<-res[which(!is.na(idx)),]
tres<-tres[idx[which(!is.na(idx))],]
full.map<-cbind(dres,tres)
View(full.map)
View(cs.res)
cs.res<-read.table(synGet('syn7810244')@filePath,sep=',',header=T)
View(cs.res)
cs.res<-read.table(synGet('syn7810244')@filePath,sep='/t',header=T)
cs.res<-read.table(synGet('syn7810244')@filePath,sep='t',header=T)
cs.res<-read.table(synGet('syn7810244')@filePath,sep="",header=T)
require(synapseClient)
synapseLogin()
cs.res<-read.delim(synGet('syn7810244')@filePath,sep="\t",header=T)
View(cs.res)
res<-synQuery("select patientID,tissueID,sampleID from entity where parentId=='syn5492805'")
tres<-synTableQuery("SELECT Patient,RnaID,TumorNumber,'RNASeq (Cufflinks)' FROM syn5556216 where RnaID is not NULL")@values
idx<-match(res$entity.id,tres$`RNASeq (Cufflinks)`)
dres<-res[which(!is.na(idx)),]
tres<-tres[idx[which(!is.na(idx))],]
full.map<-cbind(dres,tres)
sampleIds<-sapply(cs.res$Input.Sample,function(x){
y=which(full.map$entity.sampleID==gsub('”','',x))
paste("Patient",full.map$Patient[y],"Tumor",full.map$TumorNumber[y])
})
rownames(cs.res)<-sampleIds
cs.res<-cs.res[,-1]
library(pheatmap)
pheatmap(cs.res[,1:22],annotation_row=cs.res[,23:25],cellheight=10,cellwidth = 10,filename='ciberSortRePlotted.png')
rownames(cs.res)<-sampleIds

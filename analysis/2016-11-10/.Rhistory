##the PBK ids are missing from table, so need to query annotations
res<-synQuery("select patientID,tissueID,sampleID from entity where parentId=='syn5492805'")
# map<-unique(res)
#from table get generic tumor id
tres<-synTableQuery("SELECT Patient,RnaID,TumorNumber,'RNASeq (Cufflinks)' FROM syn5556216 where RnaID is not NULL")@values
idx<-match(res$entity.id,tres$`RNASeq (Cufflinks)`)
dres<-res[which(!is.na(idx)),]
tres<-tres[idx[which(!is.na(idx))],]
full.map<-cbind(dres,tres)
#map tumors to sample ids
sampleIds<-sapply(idlist,function(x){
y=which(full.map$entity.sampleID==gsub('X','',gsub('.','-',x,fixed=T)))
paste("Patient",full.map$Patient[y],"Tumor",full.map$TumorNumber[y])
})
}else if(tolower(quant)=='featurecounts'){
res<-synTableQuery("SELECT Patient,TumorNumber,RNASeq FROM syn5556216 where RNASeq is not NULL")@values
sampleIds<-sapply(idlist,function(x){
y=which(res$RNASeq==gsub('”','',x))
paste("Patient",res$Patient[y],"Tumor",res$TumorNumber[y])
})
}
return(sampleIds)
patient_tumor_number_rna<-function(idlist,quant='cuffLinks'){
if(tolower(quant)=='cufflinks'){
##the PBK ids are missing from table, so need to query annotations
res<-synQuery("select patientID,tissueID,sampleID from entity where parentId=='syn5492805'")
# map<-unique(res)
#from table get generic tumor id
tres<-synTableQuery("SELECT Patient,RnaID,TumorNumber,'RNASeq (Cufflinks)' FROM syn5556216 where RnaID is not NULL")@values
idx<-match(res$entity.id,tres$`RNASeq (Cufflinks)`)
dres<-res[which(!is.na(idx)),]
tres<-tres[idx[which(!is.na(idx))],]
full.map<-cbind(dres,tres)
#map tumors to sample ids
sampleIds<-sapply(idlist,function(x){
y=which(full.map$entity.sampleID==gsub('X','',gsub('.','-',x,fixed=T)))
paste("Patient",full.map$Patient[y],"Tumor",full.map$TumorNumber[y])
})
}else if(tolower(quant)=='featurecounts'){
res<-synTableQuery("SELECT Patient,TumorNumber,RNASeq FROM syn5556216 where RNASeq is not NULL")@values
sampleIds<-sapply(idlist,function(x){
y=which(res$RNASeq==gsub('”','',x))
paste("Patient",res$Patient[y],"Tumor",res$TumorNumber[y])
})
}
return(sampleIds)
}
rna_annotations<-function(){
synq=synapseQuery("select name,id,patientID,tissueID,alternateTumorID from entity where parentId=='syn5493036'")
colnames(synq)<-c('patientId','alternateTumorId','fileName','tissueId','synapseId')
synq=synq[grep('_featureCounts.txt',synq$fileName),]
return(synq)
}
rna_cufflinks_annotations<-function(){
synq=synapseQuery("select sampleID,patientID,tissueID,tissueType,alternateTumorID from entity where parentId=='syn5492805'")
colnames(synq)<-c('tissueType','patientID','sampleID','altTumorID','tissueID','synapseID')
return(synq)
}
source("../../bin/encodeSkinRNASeq.R")
##first check sanity of data from encode
#for(t in c('TPM','FPKM'))
#  for(a in c('hg19','grch38'))
#    clusterSamples(t,a)
##now get dermal NF data and cluster alongisde
source("../../dermalNF/bin/dermalNFData.R")
dermals=rna_fpkm_matrix(byIsoform=FALSE)
#count_matrix(stored=TRUE,doNorm=FALSE,minCount=2,doLogNorm=FALSE,doVoomNorm=TRUE)
skin=getGeneNamesForMatrix(getEncodeSkinMatrix(metric='FPKM',alignment='hg19',doVoomNorm = FALSE))
over=intersect(rownames(dermals),rownames(skin))
##which annotation should we do? Are they really just duplicates of one another?
##step 1 - just combine all
comb=cbind(dermals[over,],skin[over,])
##step 2, remove values below a particular FPKM, let's say 0.1 - for ALL genes
expr<-1:nrow(comb) #which(apply(comb,1,function(x) all(x>0.2)))
expr<-setdiff(expr,expr[union(grep('MIR',rownames(comb)[expr]),grep("SNO",rownames(comb)[expr]))])
##step 3, normalize
require(limma)
comb.norm=data.frame(voomWithQualityWeights(comb[expr,])$E)
comb.norm$Gene=rownames(comb.norm)
require(tidyr)
##norm.df<-tidyr::gather(comb.norm,"Sample","Expression",1:(ncol(comb.norm)-1))
##prc2genes <- list("SUZ12", "EED", "EZH1", "EZH2")
EED.df <- subset(norm.df, Gene=="EED")
SUZ12.df <- subset(norm.df, Gene=="SUZ12")
EZH1.df <- subset(norm.df, Gene=="EZH1")
EZH2.df <- subset(norm.df, Gene=="EZH2")
NF1.df <- subset(norm.df, Gene=="NF1")
CDKN2A.df <- subset(norm.df, Gene=="CDKN2A")
TP53.df <- subset(norm.df, Gene=="TP53")
EED.df <- tidyr::spread(EED.df, Sample, Expression)
SUZ12.df <- tidyr::spread(SUZ12.df, Sample, Expression)
EZH1.df <- tidyr::spread(EZH1.df, Sample, Expression)
EZH2.df <- tidyr::spread(EZH2.df, Sample, Expression)
NF1.df <- tidyr::spread(NF1.df, Sample, Expression)
CDKN2A.df <- tidyr::spread(CDKN2A.df, Sample, Expression)
TP53.df <- tidyr::spread(TP53.df, Sample, Expression)
comb1.df <- dplyr::bind_rows(EED.df, SUZ12.df)
comb2.df <- dplyr::bind_rows(EZH1.df, EZH2.df)
comb3.df <- dplyr::bind_rows(NF1.df, CDKN2A.df)
comb4.df <- dplyr::bind_rows(comb1.df, comb2.df)
comb4.1 <- comb4.df[,-1]
rownames(comb4.1) <- comb4.df[,1]
comb4.2 <- as.matrix(comb4.1)
heatmap(comb4.2)
comb5.df <- dplyr::bind_rows(comb4.df, comb3.df)
comb5.1 <- comb5.df[,-1]
rownames(comb5.1) <- comb5.df[,1]
comb5.2 <- as.matrix(comb5.1)
heatmap(comb5.2)
comb6.df <- dplyr::bind_rows(comb5.df, TP53.df)
comb6.1 <- comb6.df[,-1]
rownames(comb6.1) <- comb6.df[,1]
comb6.2 <- as.matrix(comb6.1)
pheatmap(comb6.2)
setwd("~/Documents/Repos/dNFLandscape/analysis/2016-11-09")
source("../../bin/encodeSkinRNASeq.R")
##first check sanity of data from encode
#for(t in c('TPM','FPKM'))
#  for(a in c('hg19','grch38'))
#    clusterSamples(t,a)
##now get dermal NF data and cluster alongisde
source("../../dermalNF/bin/dermalNFData.R")
dermals=rna_fpkm_matrix(byIsoform=FALSE)
#count_matrix(stored=TRUE,doNorm=FALSE,minCount=2,doLogNorm=FALSE,doVoomNorm=TRUE)
skin=getGeneNamesForMatrix(getEncodeSkinMatrix(metric='FPKM',alignment='hg19',doVoomNorm = FALSE))
over=intersect(rownames(dermals),rownames(skin))
##which annotation should we do? Are they really just duplicates of one another?
##step 1 - just combine all
comb=cbind(dermals[over,],skin[over,])
##step 2, remove values below a particular FPKM, let's say 0.1 - for ALL genes
expr<-1:nrow(comb) #which(apply(comb,1,function(x) all(x>0.2)))
expr<-setdiff(expr,expr[union(grep('MIR',rownames(comb)[expr]),grep("SNO",rownames(comb)[expr]))])
##step 3, normalize
require(limma)
comb.norm=data.frame(voomWithQualityWeights(comb[expr,])$E)
comb.norm$Gene=rownames(comb.norm)
require(tidyr)
##norm.df<-tidyr::gather(comb.norm,"Sample","Expression",1:(ncol(comb.norm)-1))
##prc2genes <- list("SUZ12", "EED", "EZH1", "EZH2")
EED.df <- subset(norm.df, Gene=="EED")
SUZ12.df <- subset(norm.df, Gene=="SUZ12")
EZH1.df <- subset(norm.df, Gene=="EZH1")
EZH2.df <- subset(norm.df, Gene=="EZH2")
NF1.df <- subset(norm.df, Gene=="NF1")
CDKN2A.df <- subset(norm.df, Gene=="CDKN2A")
TP53.df <- subset(norm.df, Gene=="TP53")
EED.df <- tidyr::spread(EED.df, Sample, Expression)
SUZ12.df <- tidyr::spread(SUZ12.df, Sample, Expression)
EZH1.df <- tidyr::spread(EZH1.df, Sample, Expression)
EZH2.df <- tidyr::spread(EZH2.df, Sample, Expression)
NF1.df <- tidyr::spread(NF1.df, Sample, Expression)
CDKN2A.df <- tidyr::spread(CDKN2A.df, Sample, Expression)
TP53.df <- tidyr::spread(TP53.df, Sample, Expression)
comb1.df <- dplyr::bind_rows(EED.df, SUZ12.df)
comb2.df <- dplyr::bind_rows(EZH1.df, EZH2.df)
comb3.df <- dplyr::bind_rows(NF1.df, CDKN2A.df)
comb4.df <- dplyr::bind_rows(comb1.df, comb2.df)
comb4.1 <- comb4.df[,-1]
rownames(comb4.1) <- comb4.df[,1]
comb4.2 <- as.matrix(comb4.1)
heatmap(comb4.2)
comb5.df <- dplyr::bind_rows(comb4.df, comb3.df)
comb5.1 <- comb5.df[,-1]
rownames(comb5.1) <- comb5.df[,1]
comb5.2 <- as.matrix(comb5.1)
heatmap(comb5.2)
comb6.df <- dplyr::bind_rows(comb5.df, TP53.df)
comb6.1 <- comb6.df[,-1]
rownames(comb6.1) <- comb6.df[,1]
comb6.2 <- as.matrix(comb6.1)
pheatmap(comb6.2)
norm.df<-tidyr::gather(comb.norm,"Sample","Expression",1:(ncol(comb.norm)-1))
EED.df <- subset(norm.df, Gene=="EED")
SUZ12.df <- subset(norm.df, Gene=="SUZ12")
EZH1.df <- subset(norm.df, Gene=="EZH1")
EZH2.df <- subset(norm.df, Gene=="EZH2")
NF1.df <- subset(norm.df, Gene=="NF1")
CDKN2A.df <- subset(norm.df, Gene=="CDKN2A")
TP53.df <- subset(norm.df, Gene=="TP53")
EED.df <- tidyr::spread(EED.df, Sample, Expression)
SUZ12.df <- tidyr::spread(SUZ12.df, Sample, Expression)
EZH1.df <- tidyr::spread(EZH1.df, Sample, Expression)
EZH2.df <- tidyr::spread(EZH2.df, Sample, Expression)
NF1.df <- tidyr::spread(NF1.df, Sample, Expression)
CDKN2A.df <- tidyr::spread(CDKN2A.df, Sample, Expression)
TP53.df <- tidyr::spread(TP53.df, Sample, Expression)
comb1.df <- dplyr::bind_rows(EED.df, SUZ12.df)
comb2.df <- dplyr::bind_rows(EZH1.df, EZH2.df)
comb3.df <- dplyr::bind_rows(NF1.df, CDKN2A.df)
comb4.df <- dplyr::bind_rows(comb1.df, comb2.df)
comb4.1 <- comb4.df[,-1]
rownames(comb4.1) <- comb4.df[,1]
comb4.2 <- as.matrix(comb4.1)
heatmap(comb4.2)
comb5.df <- dplyr::bind_rows(comb4.df, comb3.df)
comb5.1 <- comb5.df[,-1]
rownames(comb5.1) <- comb5.df[,1]
comb5.2 <- as.matrix(comb5.1)
heatmap(comb5.2)
comb6.df <- dplyr::bind_rows(comb5.df, TP53.df)
comb6.1 <- comb6.df[,-1]
rownames(comb6.1) <- comb6.df[,1]
comb6.2 <- as.matrix(comb6.1)
pheatmap(comb6.2)
heatmap(comb6.2)
?pheatmap()
install.packages("pheatmap")
library("pheatmap")
library(pheatmap)
pheatmap(comb6.2)
pheatmap(comb4.2)
comb5.df <- dplyr::bind_rows(comb4.df, comb3.df)
comb5.1 <- comb5.df[,-1]
rownames(comb5.1) <- comb5.df[,1]
comb5.2 <- as.matrix(comb5.1)
pheatmap(comb5.2)
pheatmap(comb6.2, cellwidth = 15, cellheight = 15)
pheatmap(comb6.2, cellwidth = 10, cellheight = 15)
pheatmap(comb6.2, cellwidth = 10, cellheight = 15, treeheight_row = 20)
pheatmap(comb6.2, cellwidth = 10, cellheight = 15, treeheight_col = 20)
pheatmap(comb6.2, cellwidth = 10, cellheight = 15, treeheight_col= 40, treeheight_row = 40, border_color = NA)
pheatmap(comb6.2, cellwidth = 10, cellheight = 15, treeheight_col= 40, treeheight_row = 40, border_color = FFFFFF)
pheatmap(comb6.2, cellwidth = 10, cellheight = 15, treeheight_col= 40, treeheight_row = 40, border_color = "white")
pheatmap(comb6.2, cellwidth = 10, cellheight = 15, treeheight_col= 40, treeheight_row = 40, border_color = "black")
pheatmap(comb6.2, cellwidth = 10, cellheight = 15, treeheight_col= 40, treeheight_row = 40, border_color = "light_grey")
pheatmap(comb6.2, cellwidth = 10, cellheight = 15, treeheight_col= 40, treeheight_row = 40, border_color = "firebrick")
pheatmap(comb6.2, cellwidth = 10, cellheight = 15, treeheight_col= 40, treeheight_row = 40, border_color = "black")
pheatmap(comb6.2, cellwidth = 10, cellheight = 15, treeheight_col= 40, treeheight_row = 40, border_color = "grey")
pheatmap(comb4.2, cellwidth = 10, cellheight = 15, treeheight_col= 40, treeheight_row = 40, border_color = "grey")
pheatmap(comb5.2, cellwidth = 10, cellheight = 15, treeheight_col= 40, treeheight_row = 40, border_color = "grey")
source("../../bin/encodeSkinRNASeq.R")
##first check sanity of data from encode
#for(t in c('TPM','FPKM'))
#  for(a in c('hg19','grch38'))
#    clusterSamples(t,a)
##now get dermal NF data and cluster alongisde
source("../../dermalNF/bin/dermalNFData.R")
dermals=rna_fpkm_matrix(byIsoform=FALSE)
#count_matrix(stored=TRUE,doNorm=FALSE,minCount=2,doLogNorm=FALSE,doVoomNorm=TRUE)
skin=getGeneNamesForMatrix(getEncodeSkinMatrix(metric='FPKM',alignment='hg19',doVoomNorm = FALSE))
over=intersect(rownames(dermals),rownames(skin))
##which annotation should we do? Are they really just duplicates of one another?
##step 1 - just combine all
comb=cbind(dermals[over,],skin[over,])
##step 2, remove values below a particular FPKM, let's say 0.1 - for ALL genes
expr<-1:nrow(comb) #which(apply(comb,1,function(x) all(x>0.2)))
expr<-setdiff(expr,expr[union(grep('MIR',rownames(comb)[expr]),grep("SNO",rownames(comb)[expr]))])
##step 3, normalize
require(limma)
comb.norm=data.frame(voomWithQualityWeights(comb[expr,])$E)
comb.norm$Gene=rownames(comb.norm)
require(tidyr)
norm.df<-tidyr::gather(comb.norm,"Sample","Expression",1:(ncol(comb.norm)-1))
##prc2genes <- list("SUZ12", "EED", "EZH1", "EZH2")
MCPT2.df <- subset(norm.df, Gene=="MCPT2")
MCPT4.df <- subset(norm.df, Gene=="MCPT4")
CMA1.df <- subset(norm.df, Gene=="CMA1")
TPSB2.df <- subset(norm.df, Gene=="TPSB2")
TPSAB1.df <- subset(norm.df, Gene=="TPSAB1")
MCPT9.df <- subset(norm.df, Gene=="MCPT9")
NF1.df <- subset(norm.df, Gene=="NF1")
MCPT2.df <- tidyr::spread(EED.df, Sample, Expression)
MCPT4.df <- tidyr::spread(SUZ12.df, Sample, Expression)
CMA1.df <- tidyr::spread(EZH1.df, Sample, Expression)
TPSB2.df <- tidyr::spread(EZH2.df, Sample, Expression)
TPSAB1.df <- tidyr::spread(NF1.df, Sample, Expression)
MCPT9.df <- tidyr::spread(CDKN2A.df, Sample, Expression)
NF1.df <- tidyr::spread(TP53.df, Sample, Expression)
comb1.df <- dplyr::bind_rows(MCPT2.df, MCPT4.df)
comb2.df <- dplyr::bind_rows(CMA1.df, TPSB2.df)
comb3.df <- dplyr::bind_rows(TPSAB1.df, MCPT9.df)
comb4.df <- dplyr::bind_rows(comb1.df, comb2.df)
comb4.1 <- comb4.df[,-1]
rownames(comb4.1) <- comb4.df[,1]
comb4.2 <- as.matrix(comb4.1)
pheatmap(comb4.2, cellwidth = 10, cellheight = 15, treeheight_col= 40, treeheight_row = 40, border_color = "grey")
comb5.df <- dplyr::bind_rows(comb4.df, comb3.df)
comb5.1 <- comb5.df[,-1]
rownames(comb5.1) <- comb5.df[,1]
comb5.2 <- as.matrix(comb5.1)
pheatmap(comb5.2, cellwidth = 10, cellheight = 15, treeheight_col= 40, treeheight_row = 40, border_color = "grey")
comb6.df <- dplyr::bind_rows(comb5.df, NF1.df)
comb6.1 <- comb6.df[,-1]
rownames(comb6.1) <- comb6.df[,1]
comb6.2 <- as.matrix(comb6.1)
library(pheatmap)
pheatmap(comb6.2, cellwidth = 10, cellheight = 15, treeheight_col= 40, treeheight_row = 40, border_color = "grey")
MCPT2.df <- tidyr::spread(MCPT2.df, Sample, Expression)
MCPT4.df <- tidyr::spread(MCPT4.df, Sample, Expression)
CMA1.df <- tidyr::spread(CMA1.df, Sample, Expression)
TPSB2.df <- tidyr::spread(TPSB2.df, Sample, Expression)
TPSAB1.df <- tidyr::spread(TPSAB1.df, Sample, Expression)
MCPT9.df <- tidyr::spread(MCPT9.df, Sample, Expression)
NF1.df <- tidyr::spread(NF1.df, Sample, Expression)
comb1.df <- dplyr::bind_rows(MCPT2.df, MCPT4.df)
comb2.df <- dplyr::bind_rows(CMA1.df, TPSB2.df)
comb3.df <- dplyr::bind_rows(TPSAB1.df, MCPT9.df)
comb4.df <- dplyr::bind_rows(comb1.df, comb2.df)
comb4.1 <- comb4.df[,-1]
rownames(comb4.1) <- comb4.df[,1]
comb4.2 <- as.matrix(comb4.1)
pheatmap(comb4.2, cellwidth = 10, cellheight = 15, treeheight_col= 40, treeheight_row = 40, border_color = "grey")
comb5.df <- dplyr::bind_rows(comb4.df, comb3.df)
comb5.1 <- comb5.df[,-1]
rownames(comb5.1) <- comb5.df[,1]
comb5.2 <- as.matrix(comb5.1)
pheatmap(comb5.2, cellwidth = 10, cellheight = 15, treeheight_col= 40, treeheight_row = 40, border_color = "grey")
comb6.df <- dplyr::bind_rows(comb5.df, NF1.df)
comb6.1 <- comb6.df[,-1]
rownames(comb6.1) <- comb6.df[,1]
comb6.2 <- as.matrix(comb6.1)
library(pheatmap)
pheatmap(comb6.2, cellwidth = 10, cellheight = 15, treeheight_col= 40, treeheight_row = 40, border_color = "grey")
setwd("~/Documents/Repos/dNFLandscape/analysis/2016-11-10")
source("../../bin/encodeSkinRNASeq.R")
##first check sanity of data from encode
#for(t in c('TPM','FPKM'))
#  for(a in c('hg19','grch38'))
#    clusterSamples(t,a)
##now get dermal NF data and cluster alongisde
source("../../dermalNF/bin/dermalNFData.R")
dermals=rna_fpkm_matrix(byIsoform=FALSE)
#count_matrix(stored=TRUE,doNorm=FALSE,minCount=2,doLogNorm=FALSE,doVoomNorm=TRUE)
skin=getGeneNamesForMatrix(getEncodeSkinMatrix(metric='FPKM',alignment='hg19',doVoomNorm = FALSE))
over=intersect(rownames(dermals),rownames(skin))
##which annotation should we do? Are they really just duplicates of one another?
##step 1 - just combine all
comb=cbind(dermals[over,],skin[over,])
##step 2, remove values below a particular FPKM, let's say 0.1 - for ALL genes
expr<-1:nrow(comb) #which(apply(comb,1,function(x) all(x>0.2)))
expr<-setdiff(expr,expr[union(grep('MIR',rownames(comb)[expr]),grep("SNO",rownames(comb)[expr]))])
##step 3, normalize
require(limma)
comb.norm=data.frame(voomWithQualityWeights(comb[expr,])$E)
comb.norm$Gene=rownames(comb.norm)
require(tidyr)
norm.df<-tidyr::gather(comb.norm,"Sample","Expression",1:(ncol(comb.norm)-1))
##prc2genes <- list("SUZ12", "EED", "EZH1", "EZH2")
MCPT2.df <- subset(norm.df, Gene=="MCPT2")
MCPT4.df <- subset(norm.df, Gene=="MCPT4")
CMA1.df <- subset(norm.df, Gene=="CMA1")
TPSB2.df <- subset(norm.df, Gene=="TPSB2")
TPSAB1.df <- subset(norm.df, Gene=="TPSAB1")
MCPT9.df <- subset(norm.df, Gene=="MCPT9")
NF1.df <- subset(norm.df, Gene=="NF1")
MCPT2.df <- tidyr::spread(MCPT2.df, Sample, Expression)
MCPT4.df <- tidyr::spread(MCPT4.df, Sample, Expression)
CMA1.df <- tidyr::spread(CMA1.df, Sample, Expression)
TPSB2.df <- tidyr::spread(TPSB2.df, Sample, Expression)
TPSAB1.df <- tidyr::spread(TPSAB1.df, Sample, Expression)
MCPT9.df <- tidyr::spread(MCPT9.df, Sample, Expression)
NF1.df <- tidyr::spread(NF1.df, Sample, Expression)
comb1.df <- dplyr::bind_rows(MCPT2.df, MCPT4.df)
comb2.df <- dplyr::bind_rows(CMA1.df, TPSB2.df)
comb3.df <- dplyr::bind_rows(TPSAB1.df, MCPT9.df)
comb4.df <- dplyr::bind_rows(comb1.df, comb2.df)
comb4.1 <- comb4.df[,-1]
rownames(comb4.1) <- comb4.df[,1]
comb4.2 <- as.matrix(comb4.1)
pheatmap(comb4.2, cellwidth = 10, cellheight = 15, treeheight_col= 40, treeheight_row = 40, border_color = "grey")
comb5.df <- dplyr::bind_rows(comb4.df, comb3.df)
comb5.1 <- comb5.df[,-1]
rownames(comb5.1) <- comb5.df[,1]
comb5.2 <- as.matrix(comb5.1)
pheatmap(comb5.2, cellwidth = 10, cellheight = 15, treeheight_col= 40, treeheight_row = 40, border_color = "grey")
comb6.df <- dplyr::bind_rows(comb5.df, NF1.df)
comb6.1 <- comb6.df[,-1]
rownames(comb6.1) <- comb6.df[,1]
comb6.2 <- as.matrix(comb6.1)
library(pheatmap)
pheatmap(comb6.2, cellwidth = 10, cellheight = 15, treeheight_col= 40, treeheight_row = 40, border_color = "grey")
mastsig.df <- filter(norm.df)
View(MCPT2.df)
View(MCPT4.df)
View(MCPT9.df)
View(EZH2.df)
View(EZH1.df)
View(EED.df)
View(MCPT2.df)
View(MCPT4.df)
View(MCPT9.df)
View(CMA1.df)
mastsig.df <- filter(norm.df$Gene == "CMA1" OR "CMA2")
mastsig <- c("CMA1", "CMA2")
mastsig.df <- dplyr::filter(norm.df$Gene %in% mastsig)
dplyr::filter(norm.df$Gene %in% mastsig)
dplyr::filter(norm.df, Gene %in% mastsig)
mastsig.df <- dplyr::filter(norm.df, Gene %in% mastsig)
mastsig <- c("KIT", "IL1RL1", "FCER1A", "MS4A2", "ENPP3", "HDC", "TPSAB1", "TPSB2", "TPSD1", "CMA1", "CPA3", "CTSG", "HPGD5", "LTC45")
mastsig.df <- dplyr::filter(norm.df, Gene %in% mastsig)
View(mastsig.df)
View(mastsig.df)
mastsiggrouped.df <- dplyr::group_by(mastsig.df, Gene)
View(mastsiggrouped.df)
View(mastsiggrouped.df)
View(mastsiggrouped.df)
mastsig.df <- dplyr::spread(mastsig.df, Gene)
mastsig.df <- tidyr::spread(mastsig.df, Gene)
?spread
View(mastsig.df)
mastsig.df <- tidyr::spread(mastsig.df, Gene, Expression)
View(mastsig.df)
mastsig.col <- mastsig.df[,-1]
rownames(mastsig.col) <- mastsig.df[,1]
View(mastsig.df)
View(mastsig.col)
mastsig.m <- as.matrix(mastsig.col)
View(mastsig.m)
pheatmap(mastsig.m, cellwidth = 10, cellheight = 15, treeheight_col= 40, treeheight_row = 40, border_color = "grey")
pheatmap(mastsig.m, cellwidth = 10, cellheight = 10, treeheight_col= 40, treeheight_row = 40, border_color = "grey")
pheatmap(mastsig.m, cellwidth = 5, cellheight = 5, treeheight_col= 40, treeheight_row = 40, border_color = "grey")
pheatmap(mastsig.m, cellwidth = 10, cellheight = 10, treeheight_col= 40, treeheight_row = 40, border_color = "grey")
pheatmap(mastsig2.m, cellwidth = 10, cellheight = 10, treeheight_col= 40, treeheight_row = 40, border_color = "grey")
mastsig2 <- c("MRGPRX2", "RGS13", "C1orf150", "SIGLEC6", "ERVFRD-1", "SVOPL", "C20orf118", "VWASA")
#new mast cell expression signature from http://www.bloodjournal.org/content/123/17/e58.long
mastsig2.df <- dplyr::filter(norm.df, Gene %in% mastsig)
mastsig2.df <- tidyr::spread(mastsig2.df, Gene, Expression)
mastsig2.col <- mastsig2.df[,-1]
rownames(mastsig2.col) <- mastsig2.df[,1]
mastsig2.m <- as.matrix(mastsig2.col)
pheatmap(mastsig2.m, cellwidth = 10, cellheight = 10, treeheight_col= 40, treeheight_row = 40, border_color = "grey")
mastsig2 <- c("MRGPRX2", "RGS13", "C1orf150", "SIGLEC6", "ERVFRD-1", "SVOPL", "C20orf118", "VWASA")
#new mast cell expression signature from http://www.bloodjournal.org/content/123/17/e58.long
mastsig2.df <- dplyr::filter(norm.df, Gene %in% mastsig)
mastsig2.df <- tidyr::spread(mastsig2.df, Gene, Expression)
mastsig2.col <- mastsig2.df[,-1]
rownames(mastsig2.col) <- mastsig2.df[,1]
mastsig2.m <- as.matrix(mastsig2.col)
pheatmap(mastsig2.m, cellwidth = 10, cellheight = 10, treeheight_col= 40, treeheight_row = 40, border_color = "grey")
View(mastsig2.df)
View(mastsig2.m)
mastsig2 <- c("MRGPRX2", "RGS13", "C1orf150", "SIGLEC6", "ERVFRD-1", "SVOPL", "C20orf118", "VWASA")
mastsig2.df <- dplyr::filter(norm.df, Gene %in% mastsig)
mastsig2.df <- tidyr::spread(mastsig2.df, Gene, Expression)
mastsig2.col <- mastsig2.df[,-1]
rownames(mastsig2.col) <- mastsig2.df[,1]
mastsig2.m <- as.matrix(mastsig2.col)
pheatmap(mastsig2.m, cellwidth = 10, cellheight = 10, treeheight_col= 40, treeheight_row = 40, border_color = "grey")
View(mastsig2.col)
View(mastsig2.col)
View(mastsig2.df)
View(mastsig2.col)
mastsig2.df <- dplyr::filter(norm.df, Gene %in% mastsig2)
mastsig2.df <- tidyr::spread(mastsig2.df, Gene, Expression)
mastsig2.col <- mastsig2.df[,-1]
rownames(mastsig2.col) <- mastsig2.df[,1]
mastsig2.m <- as.matrix(mastsig2.col)
pheatmap(mastsig2.m, cellwidth = 10, cellheight = 10, treeheight_col= 40, treeheight_row = 40, border_color = "grey")
pheatmap(mastsig2.m, cellwidth = 10, cellheight = 10, treeheight_col= 40, treeheight_row = 40, border_color = "grey", margins =c(5,10))
pheatmap(mastsig2.m, cellwidth = 10, cellheight = 10, treeheight_col= 40, treeheight_row = 40, border_color = "grey", margins =c(100,100))
?pheatmap
pheatmap(mastsig2.m, cellwidth = 10, cellheight = 10, treeheight_col= 40, treeheight_row = 40, border_color = "grey", width = 5, height = 5)
pheatmap(mastsig2.m, cellwidth = 10, cellheight = 10, treeheight_col= 40, treeheight_row = 40, border_color = "grey", width = 2, height = 2)
pheatmap(mastsig2.m, cellwidth = 10, cellheight = 10, fontsize = 5, treeheight_col= 40, treeheight_row = 40, border_color = "grey")
pheatmap(mastsig2.m, cellwidth = 5, cellheight = 5, fontsize = 5, treeheight_col= 40, treeheight_row = 40, border_color = "grey")
pheatmap(mastsig.m, cellwidth = 5, cellheight = 5, fontsize = 5, treeheight_col= 40, treeheight_row = 40, border_color = "grey")
View(mastsig.col)
View(mastsig.df)
View(mastsig.col)
pheatmap,
colnames(mastsig2.m)
rownames(mastsig2.m)
samples <- colnames(mastsig.m)
samples <- colnames(mastsig2.m)
samples <- rownames(mastsig.m)
?matrix
tumorsize.m <- c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66)
sizes <- c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66)
tumorsize.m <- matrix(data = sizes, nrow = 66, ncol = 1)
View(tumorsize.m)
View(tumorsize.m)
tumorsize.m <- matrix(data = sizes, nrow = 66, ncol = 1, dimnames = c(samples, "Size"))
tumorsize.titles - c(samples, "Size")
tumorsize.titles = c(samples, "Size")
tumorsize.m <- matrix(data = sizes, nrow = 66, ncol = 1, dimnames = tumorsize.titles)
tumorsize.m <- matrix(data = sizes, nrow = 66, ncol = 1, dimnames = (list(samples, "Size")))
View(tumorsize.m)
View(tumorsize.m)
?pheatmap
pheatmap(mastsig.m, cellwidth = 5, cellheight = 5, fontsize = 5, treeheight_col= 40, treeheight_row = 40, border_color = "grey", annotation_row = tumorsize.m)
samples <- rownames(mastsig.m)
sizes <- c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66)
tumorsize.m <- matrix(data = sizes, nrow = 66, ncol = 1, dimnames = (list(samples, "Size")))
pheatmap(mastsig.m, cellwidth = 5, cellheight = 5, fontsize = 5, treeheight_col= 40, treeheight_row = 40, border_color = "grey", annotation_row = tumorsize.m)
pheatmap(mastsig.m, cellwidth = 5, cellheight = 5, fontsize = 5, treeheight_col= 40, treeheight_row = 40, border_color = "grey", annotation_names_row = tumorsize.m)
tumorsize.m <- data.frame(data = sizes, nrow = 66, ncol = 1, dimnames = (list(samples, "Size")))
tumorsize <- data.frame(data = sizes, nrow = 66, ncol = 1, dimnames = (list(samples, "Size")))
pheatmap(mastsig.m, cellwidth = 5, cellheight = 5, fontsize = 5, treeheight_col= 40, treeheight_row = 40, border_color = "grey", annotation_row = tumorsize)
View(tumorsize.m)
View(tumorsize)
View(tumorsize)
tumorsize <- matrix(data = sizes, nrow = 66, ncol = 1, dimnames = (list(samples, "Size")))
View(tumorsize)
View(tumorsize)
pheatmap(mastsig.m, cellwidth = 5, cellheight = 5, fontsize = 5, treeheight_col= 40, treeheight_row = 40, border_color = "grey", annotation_row = tumorsize.m)
pheatmap?
?pheatmap
?pheatmap
pheatmap(mastsig.m, cellwidth = 5, cellheight = 5, fontsize = 5, treeheight_col= 40, treeheight_row = 40, border_color = "grey", annotation_row = tumorsize.m)
samples <- rownames(mastsig.m)
sizes <- c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66)
tumorsize.m <- matrix(data = sizes, nrow = 66, ncol = 1, dimnames = (list(samples, "Size")))
pheatmap(mastsig.m, cellwidth = 5, cellheight = 5, fontsize = 5, treeheight_col= 40, treeheight_row = 40, border_color = "grey", annotation_row = tumorsize.m)
View(tumorsize.m)
pheatmap(mastsig.m, cellwidth = 5, cellheight = 5, fontsize = 5, treeheight_col= 40, treeheight_row = 40, border_color = "grey")
tumorsize.df <- as.data.frame(tumorsize.m)
View(tumorsize.m)
View(tumorsize.df)
pheatmap(mastsig.m, cellwidth = 5, cellheight = 5, fontsize = 5, treeheight_col= 40, treeheight_row = 40, border_color = "grey", annotation_row = tumorsize.df)
pheatmap(mastsig.m, cellwidth = 5, cellheight = 5, fontsize = 5, treeheight_col= 40, treeheight_row = 40, border_color = "grey", annotation_row = tumorsize.df & tumorsize.df)
pheatmap(mastsig.m, cellwidth = 5, cellheight = 5, fontsize = 5, treeheight_col= 40, treeheight_row = 40, border_color = "grey", annotation_row = tumorsize.df, annotation_row = tumorsize.df)
pheatmap(mastsig.m, cellwidth = 5, cellheight = 5, fontsize = 5, treeheight_col= 40, treeheight_row = 40, border_color = "grey", annotation_row = tumorsize.df AND tumorsize.df)
